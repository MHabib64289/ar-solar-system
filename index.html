<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AR Solar System - Earth Marker</title>
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar.js"></script>
  <style>
    body { margin: 0; overflow: hidden; font-family: system-ui, sans-serif; }
    
    .ui-overlay {
      position: fixed; top: 20px; left: 20px; z-index: 999;
      color: white; background: rgba(0,0,0,0.9);
      padding: 16px 22px; border-radius: 14px;
      max-width: 320px; font-size: 13px; line-height: 1.6;
      box-shadow: 0 8px 24px rgba(0,0,0,0.5);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .ui-overlay strong {
      display: block; font-size: 18px;
      margin-bottom: 10px; color: #4fc3f7; font-weight: 700;
    }
    
    .instruction {
      background: rgba(255, 152, 0, 0.2);
      border-left: 3px solid #ff9800;
      padding: 10px 12px; margin-top: 12px;
      border-radius: 6px; font-size: 11px;
      color: #ffcc80;
    }
    
    .status {
      margin-top: 10px; padding-top: 10px;
      border-top: 1px solid rgba(255,255,255,0.2);
      font-size: 12px; opacity: 0.95;
    }

    .controls {
      position: fixed; bottom: 30px;
      left: 50%; transform: translateX(-50%);
      z-index: 999; display: flex; gap: 12px;
      flex-wrap: wrap; justify-content: center;
      max-width: 90%;
    }
    
    button {
      background: linear-gradient(135deg, rgba(79, 195, 247, 0.95), rgba(41, 182, 246, 0.95));
      border: none; padding: 14px 22px; border-radius: 28px;
      font-weight: 700; cursor: pointer; font-size: 13px;
      color: white; box-shadow: 0 4px 16px rgba(79, 195, 247, 0.4);
      transition: all 0.2s; display: flex;
      align-items: center; gap: 8px;
      border: 2px solid rgba(255,255,255,0.3);
    }
    
    button:active {
      transform: scale(0.96);
      box-shadow: 0 2px 8px rgba(79, 195, 247, 0.6);
    }

    .marker-help {
      position: fixed; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      z-index: 998; text-align: center;
      pointer-events: none;
    }
    
    .marker-frame {
      width: 260px; height: 260px;
      border: 4px dashed rgba(79, 195, 247, 0.8);
      border-radius: 20px; margin: 0 auto 20px;
      animation: pulse 2s infinite;
      box-shadow: 0 0 30px rgba(79, 195, 247, 0.4);
      background: rgba(79, 195, 247, 0.05);
    }
    
    @keyframes pulse {
      0%, 100% { 
        opacity: 0.5; transform: scale(1);
        border-color: rgba(79, 195, 247, 0.5);
      }
      50% { 
        opacity: 1; transform: scale(1.05);
        border-color: rgba(79, 195, 247, 1);
      }
    }
    
    .marker-text {
      color: white; background: rgba(0,0,0,0.9);
      padding: 16px 28px; border-radius: 12px;
      font-size: 15px; font-weight: 700;
      backdrop-filter: blur(12px);
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    .hidden { display: none !important; }
    
    @media (max-width: 600px) {
      .controls { bottom: 20px; gap: 10px; }
      button { padding: 12px 18px; font-size: 12px; }
      .marker-frame { width: 200px; height: 200px; }
      .ui-overlay { max-width: 260px; font-size: 12px; }
    }
  </style>
</head>
<body>
  <div class="ui-overlay">
    <strong>üåç AR Solar System HD</strong>
    <div>Marker: <span style="color: #4caf50; font-weight: 600;">Hiro (Default)</span></div>
    <div class="status" id="status">Siap scan marker...</div>
    <div class="instruction">
      üìù <strong>Ganti Marker Custom:</strong><br>
      Lihat baris <strong>203</strong> di kode HTML!<br>
      Ganti <code>preset="hiro"</code> dengan pattern Anda
    </div>
  </div>

  <div class="marker-help" id="markerHelp">
    <div class="marker-frame"></div>
    <div class="marker-text">
      Arahkan kamera ke<br><strong>HIRO MARKER</strong>
    </div>
  </div>

  <div class="controls">
    <button onclick="toggleEclipse()">
      <span id="eclipseIcon">üåë</span>
      <span id="eclipseText">Gerhana</span>
    </button>
    <button onclick="toggleSpeed()">
      <span>‚ö°</span>
      <span id="speedText">1x</span>
    </button>
    <button onclick="toggleRotate()">
      <span id="rotateIcon">üîÑ</span>
      <span id="rotateText">Putar</span>
    </button>
    <button onclick="resetCamera()">
      <span>üì∑</span>
      <span>Reset</span>
    </button>
  </div>

  <a-scene
    embedded
    arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
    vr-mode-ui="enabled: false"
    renderer="logarithmicDepthBuffer: true; precision: high; antialias: true; alpha: true; colorManagement: true;"
    loading-screen="enabled: false"
    id="arScene">
    
    <a-assets timeout="30000">
      <img id="earthTexture" src="https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/earth_atmos_2048.jpg" crossorigin="anonymous">
      <img id="moonTexture" src="https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/moon_1024.jpg" crossorigin="anonymous">
      <img id="sunTexture" src="https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/planets/sun.jpg" crossorigin="anonymous">
    </a-assets>

    <a-entity camera look-controls="enabled: false"></a-entity>

    <!-- ============================================ -->
    <!-- üî• INI BARIS MARKER YANG PERLU DIGANTI! üî• -->
    <!-- BARIS 203-211 -->
    <!-- ============================================ -->
    
    <!-- OPSI 1: Pakai HIRO (Default - sudah jalan) -->
    <a-marker 
  type="pattern" 
  url="pattern-earth.patt"
  id="mainMarker" 
  smooth="true" 
  smoothCount="10" 
  smoothTolerance="0.01" 
  smoothThreshold="5">
    
    <!-- OPSI 2: Pakai PATTERN CUSTOM (Uncomment & ganti URL) -->
    <!-- 
    <a-marker 
      type="pattern" 
      url="pattern-earth.patt"
      id="mainMarker" 
      smooth="true" 
      smoothCount="10" 
      smoothTolerance="0.01" 
      smoothThreshold="5">
    -->
    
    <!-- ============================================ -->
    <!-- üî• AKHIR BARIS MARKER üî• -->
    <!-- ============================================ -->
      
      <a-entity id="solarSystem" scale="0.8 0.8 0.8" position="0 0 0">
        
        <!-- Sun -->
        <a-entity id="sun" position="-4 0.5 0">
          <a-sphere 
            radius="0.8" 
            src="#sunTexture"
            segments-width="64"
            segments-height="64"
            material="emissive: #ff6600; emissiveIntensity: 0.8; shader: standard"
            animation="property: rotation; to: 0 360 0; dur: 20000; loop: true; easing: linear">
          </a-sphere>
          
          <a-sphere radius="0.9" color="#ffcc44" segments-width="32" segments-height="32" material="transparent: true; opacity: 0.4; side: double; shader: flat" animation="property: scale; to: 1.15 1.15 1.15; dir: alternate; dur: 2000; loop: true; easing: easeInOutSine"></a-sphere>
          <a-sphere radius="1.05" color="#ff9933" segments-width="32" segments-height="32" material="transparent: true; opacity: 0.25; side: double; shader: flat" animation="property: scale; to: 1.2 1.2 1.2; dir: alternate; dur: 2500; loop: true; easing: easeInOutSine"></a-sphere>
          <a-sphere radius="1.25" color="#ff7722" segments-width="32" segments-height="32" material="transparent: true; opacity: 0.15; side: double; shader: flat" animation="property: scale; to: 1.3 1.3 1.3; dir: alternate; dur: 3000; loop: true; easing: easeInOutSine"></a-sphere>

          <a-sphere id="corona1" radius="1.1" color="#ffffdd" segments-width="32" segments-height="32" material="transparent: true; opacity: 0; side: back; shader: flat" visible="false"></a-sphere>
          <a-sphere id="corona2" radius="1.4" color="#ffffaa" segments-width="32" segments-height="32" material="transparent: true; opacity: 0; side: back; shader: flat" visible="false"></a-sphere>
          <a-sphere id="corona3" radius="1.8" color="#ffeeaa" segments-width="32" segments-height="32" material="transparent: true; opacity: 0; side: back; shader: flat" visible="false"></a-sphere>
        </a-entity>

        <!-- Earth System -->
        <a-entity id="earthSystem" rotation="0 0 -23.4">
          <a-sphere id="earth" radius="0.65" src="#earthTexture" segments-width="64" segments-height="64" material="shader: standard; metalness: 0.1; roughness: 0.7" animation="property: rotation; to: 0 360 0; dur: 12000; loop: true; easing: linear">
            <a-sphere radius="0.651" color="#112244" segments-width="48" segments-height="48" material="transparent: true; opacity: 0.3; metalness: 0.9; roughness: 0.2; shader: standard"></a-sphere>
            <a-sphere radius="0.66" color="#ffffff" segments-width="48" segments-height="48" material="transparent: true; opacity: 0.5; shader: standard" animation="property: rotation; to: 0 370 0; dur: 14000; loop: true; easing: linear"></a-sphere>
            <a-sphere radius="0.7" color="#5599ff" segments-width="32" segments-height="32" material="transparent: true; opacity: 0.2; side: back; shader: flat"></a-sphere>
            <a-sphere radius="0.75" color="#3388ff" segments-width="24" segments-height="24" material="transparent: true; opacity: 0.1; side: back; shader: flat"></a-sphere>
          </a-sphere>

          <a-entity id="moonOrbit" animation="property: rotation; to: 0 360 0; dur: 18000; loop: true; easing: linear; pauseEvents: pauseRotation; resumeEvents: resumeRotation">
            <a-sphere id="moon" position="2 0.2 0" radius="0.18" src="#moonTexture" segments-width="48" segments-height="48" material="shader: standard; roughness: 0.95; metalness: 0" animation="property: rotation; to: 0 360 0; dur: 27000; loop: true; easing: linear"></a-sphere>
            <a-ring radius-inner="1.95" radius-outer="1.98" color="#99aacc" segments-theta="128" material="transparent: true; opacity: 0.25; side: double; shader: flat" rotation="-90 0 0"></a-ring>
            <a-ring radius-inner="1.93" radius-outer="2.0" color="#5577aa" segments-theta="128" material="transparent: true; opacity: 0.1; side: double; shader: flat" rotation="-90 0 0"></a-ring>
          </a-entity>
        </a-entity>

        <a-entity id="stars" position="0 0 0"></a-entity>
        <a-entity id="dust" position="0 0 0"></a-entity>

        <a-light type="ambient" color="#404050" intensity="0.6"></a-light>
        <a-light type="directional" color="#ffffee" intensity="1.5" position="-4 1 2" id="sunLight"></a-light>
        <a-light type="point" color="#6688aa" intensity="0.3" position="3 -1 -2"></a-light>
      </a-entity>
    </a-marker>
  </a-scene>

  <script>
    let eclipseMode = false;
    let speedMultiplier = 1;
    let rotationPaused = false;
    let markerVisible = false;

    window.addEventListener('load', () => {
      const starsEl = document.querySelector('#stars');
      if (starsEl) {
        for (let i = 0; i < 200; i++) {
          const star = document.createElement('a-sphere');
          const x = (Math.random() - 0.5) * 30;
          const y = (Math.random() - 0.5) * 30;
          const z = (Math.random() - 0.5) * 30;
          const size = Math.random() * 0.03 + 0.01;
          const brightness = Math.random() * 0.5 + 0.5;
          
          star.setAttribute('position', `${x} ${y} ${z}`);
          star.setAttribute('radius', size);
          star.setAttribute('color', '#ffffff');
          star.setAttribute('material', `shader: flat; opacity: ${brightness}`);
          
          if (Math.random() > 0.7) {
            star.setAttribute('animation', `property: material.opacity; to: ${brightness * 0.3}; dur: ${Math.random() * 2000 + 1000}; dir: alternate; loop: true; easing: easeInOutSine`);
          }
          
          starsEl.appendChild(star);
        }
      }

      const dustEl = document.querySelector('#dust');
      if (dustEl) {
        for (let i = 0; i < 50; i++) {
          const dust = document.createElement('a-sphere');
          const x = (Math.random() - 0.5) * 15;
          const y = (Math.random() - 0.5) * 15;
          const z = (Math.random() - 0.5) * 15;
          
          dust.setAttribute('position', `${x} ${y} ${z}`);
          dust.setAttribute('radius', '0.015');
          dust.setAttribute('color', '#8899aa');
          dust.setAttribute('material', 'shader: flat; opacity: 0.4; transparent: true');
          
          dustEl.appendChild(dust);
        }
      }

      updateStatus('üìπ Kamera aktif - Scan Hiro Marker');
    });

    const marker = document.querySelector('#mainMarker');
    if (marker) {
      marker.addEventListener('markerFound', () => {
        markerVisible = true;
        document.getElementById('markerHelp').classList.add('hidden');
        updateStatus('‚úÖ Marker terdeteksi! üéâ');
      });

      marker.addEventListener('markerLost', () => {
        markerVisible = false;
        document.getElementById('markerHelp').classList.remove('hidden');
        updateStatus('‚ùå Marker hilang - scan ulang');
      });
    }

    function toggleEclipse() {
      eclipseMode = !eclipseMode;
      const corona1 = document.querySelector('#corona1');
      const corona2 = document.querySelector('#corona2');
      const corona3 = document.querySelector('#corona3');
      const sunLight = document.querySelector('#sunLight');
      const icon = document.querySelector('#eclipseIcon');
      const text = document.querySelector('#eclipseText');
      
      if (eclipseMode) {
        if (corona1) {
          corona1.setAttribute('visible', 'true');
          corona1.setAttribute('material', 'opacity', '0.5');
          corona1.setAttribute('animation', 'property: rotation; to: 0 360 0; dur: 8000; loop: true; easing: linear');
        }
        if (corona2) {
          corona2.setAttribute('visible', 'true');
          corona2.setAttribute('material', 'opacity', '0.3');
          corona2.setAttribute('animation', 'property: rotation; to: 0 -360 0; dur: 12000; loop: true; easing: linear');
        }
        if (corona3) {
          corona3.setAttribute('visible', 'true');
          corona3.setAttribute('material', 'opacity', '0.2');
          corona3.setAttribute('animation', 'property: rotation; to: 0 360 0; dur: 16000; loop: true; easing: linear');
        }
        
        if (sunLight) sunLight.setAttribute('intensity', '0.3');
        
        const moonOrbit = document.querySelector('#moonOrbit');
        if (moonOrbit) {
          moonOrbit.setAttribute('animation', 'property: rotation; to: 0 360 0; dur: 35000; loop: true; easing: linear');
        }
        
        icon.textContent = '‚òÄÔ∏è';
        text.textContent = 'Normal';
        updateStatus('üåë Mode GERHANA!');
      } else {
        if (corona1) corona1.setAttribute('visible', 'false');
        if (corona2) corona2.setAttribute('visible', 'false');
        if (corona3) corona3.setAttribute('visible', 'false');
        
        if (sunLight) sunLight.setAttribute('intensity', '1.5');
        
        const moonOrbit = document.querySelector('#moonOrbit');
        if (moonOrbit) {
          moonOrbit.setAttribute('animation', 'property: rotation; to: 0 360 0; dur: 18000; loop: true; easing: linear');
        }
        
        icon.textContent = 'üåë';
        text.textContent = 'Gerhana';
        updateStatus('‚òÄÔ∏è Mode Normal');
      }
    }

    function toggleSpeed() {
      const speeds = [1, 2, 0.5, 4];
      const currentIndex = speeds.indexOf(speedMultiplier);
      speedMultiplier = speeds[(currentIndex + 1) % speeds.length];
      
      const speedText = document.querySelector('#speedText');
      speedText.textContent = `${speedMultiplier}x`;
      
      const earth = document.querySelector('#earth');
      const moonOrbit = document.querySelector('#moonOrbit');
      
      if (earth) {
        const baseDur = 12000;
        earth.setAttribute('animation', `property: rotation; to: 0 360 0; dur: ${baseDur / speedMultiplier}; loop: true; easing: linear`);
      }
      
      if (moonOrbit) {
        const baseDur = eclipseMode ? 35000 : 18000;
        moonOrbit.setAttribute('animation', `property: rotation; to: 0 360 0; dur: ${baseDur / speedMultiplier}; loop: true; easing: linear`);
      }
      
      updateStatus(`‚ö° ${speedMultiplier}x`);
    }

    function toggleRotate() {
      rotationPaused = !rotationPaused;
      const icon = document.querySelector('#rotateIcon');
      const text = document.querySelector('#rotateText');
      const moonOrbit = document.querySelector('#moonOrbit');
      
      if (rotationPaused) {
        if (moonOrbit) moonOrbit.emit('pauseRotation');
        icon.textContent = '‚ñ∂Ô∏è';
        text.textContent = 'Lanjut';
        updateStatus('‚è∏Ô∏è PAUSE');
      } else {
        if (moonOrbit) moonOrbit.emit('resumeRotation');
        icon.textContent = 'üîÑ';
        text.textContent = 'Putar';
        updateStatus('‚ñ∂Ô∏è PLAY');
      }
    }

    function resetCamera() {
      const solarSystem = document.querySelector('#solarSystem');
      if (solarSystem) {
        solarSystem.setAttribute('scale', '0.8 0.8 0.8');
        solarSystem.setAttribute('position', '0 0 0');
      }
      updateStatus('üì∑ Reset');
    }

    function updateStatus(msg) {
      const statusEl = document.getElementById('status');
      if (statusEl) statusEl.textContent = msg;
    }

    const arScene = document.querySelector('#arScene');
    if (arScene) {
      arScene.addEventListener('arjs-video-loaded', () => {
        updateStatus('üìπ Siap scan!');
      });
    }
  </script>
</body>
</html>